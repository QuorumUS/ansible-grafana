---
grafana_version: latest
grafana_yum_repo_template: etc/yum.repos.d/grafana.repo.j2

# Should we use the provisioning capability when possible (provisioning require grafana >= 5.0)
grafana_use_provisioning: true

# Should the provisioning be kept synced. If true, previous provisioned objects will be removed if not referenced anymore.
grafana_provisioning_synced: false

grafana_instance: "{{ ansible_fqdn | default(ansible_host) | default(inventory_hostname) }}"

grafana_logs_dir: "/var/log/grafana"
grafana_data_dir: "/var/lib/grafana"

grafana_address: "0.0.0.0"
grafana_port: 3000
# To enable the use of ports below 1024 for unprivileged processes linux needs to set CAP_NET_BIND_SERVICE.
# This has some security implications, and should be a conscious choice.
# Get informed by reading: http://man7.org/linux/man-pages/man7/capabilities.7.html
grafana_cap_net_bind_service: false

# External Grafana address. Variable maps to "root_url" in grafana server section
# grafana_url: "http://{{ grafana_address }}:{{ grafana_port }}"
grafana_fqdn: better-monitoring.quorum.us
grafana_url: "http://{{ grafana_fqdn }}:{{ grafana_port }}"
grafana_api_url: "{{ grafana_url }}"
grafana_domain: "{{ ansible_fqdn | default(ansible_host) | default('localhost') }}"

# Additional options for grafana "server" section
# This section WILL omit options for: http_addr, http_port, domain, and root_url, as those settings are set by variables listed before
grafana_server:
  protocol: http
  enforce_domain: false
  socket: ""
  cert_key: ""
  cert_file: ""
  enable_gzip: false
  static_root_path: public
  router_logging: false
  serve_from_sub_path: false

# Variables correspond to ones in grafana.ini configuration file
# Security
grafana_security:
  admin_user: admin
  admin_password: !vault |
    $ANSIBLE_VAULT;1.1;AES256
    35636261633231323164363862306463653762643363663965353461323138336536376336623530
    3665626331316135653362343765333630333637626437630a653435383330306466386332323732
    33356266363233313461373634366336393366366539643661653363373763646366636432376439
    3066336634353735390a333834396637353634623937353238323935306566623336656632383239
    3530
#  secret_key: ""
#  login_remember_days: 7
#  cookie_username: grafana_user
#  cookie_remember_name: grafana_remember
#  disable_gravatar: true
#  data_source_proxy_whitelist:

# Database setup
grafana_database:
  type: sqlite3
#  host: 127.0.0.1:3306
#  name: grafana
#  user: root
#  password: ""
#  url: ""
#  ssl_mode: disable
#  path: grafana.db
#  max_idle_conn: 2
#  max_open_conn: ""
#  log_queries: ""

# User management and registration
grafana_welcome_email_on_sign_up: false
grafana_users:
  allow_sign_up: false
  # allow_org_create: true
  # auto_assign_org: true
  auto_assign_org_role: Viewer
  # login_hint: "email or username"
  default_theme: dark
  # external_manage_link_url: ""
  # external_manage_link_name: ""
  # external_manage_info: ""

# grafana authentication mechanisms
grafana_auth:
  # github:
  #   enabled: true
  #   allow_sign_up: true
  #   client_id: !vault |
  #     $ANSIBLE_VAULT;1.1;AES256
  #     64323539653164643231626161373336343663303965666534616438363730323266386166363230
  #     6361326561656662356362646333343432366162366538350a343735656430373936633636656462
  #     30623437376434356339343665653765303763663830326235653065356137613136393130363565
  #     3036343237636338390a383338323236366461623563393938393464643532356363663265356635
  #     36376535316232663337613032336433376239616564613733303065356563326265
  #   client_secret: !vault |
  #     $ANSIBLE_VAULT;1.1;AES256
  #     34396639626637633261313831666436376139396565303035316630363961646265326533326362
  #     6166383931383563316665643936356337373530373931660a316463396239333532623533373566
  #     33643462336130313933616439386561326561626236316230663034313937363531623261343463
  #     6234303135373737320a366533656636636365386462653130383066656265613139336231633665
  #     35336138616139656331326534343832376663656363343835623439663063663535333562363837
  #     3866333364373437663565633437616431653038626561663630
  #   scopes: "user:email,read:org"
  #   auth_url: https://github.com/login/oauth/authorize
  #   token_url: https://github.com/login/oauth/access_token
  #   api_url: https://api.github.com/user

  # https://grafana.com/docs/auth/google/
  google:
    enabled: true
    client_id: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      61653639653766396237306364356165336234326337616566353536666563343864323133346233
      3366343534383931613737666162336266363166366631330a643530656134386562363661356634
      38373932316261326439636638353539396264653130613737306361623866393532636261353533
      3737353237626632330a316165303862393537396631643632353532636439313164393532316339
      62663333643631373030613537326332653131616134623735383433306361353837356338383437
      66643437376163393638383039613062396366366265326362326265363336396365366333613963
      35616466396662343933323066663738376365396532356534313862666338663736396435646463
      61623238393632616137
    client_secret: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      38626366376561626366616534346333366464356232306534396366353662613866613065393135
      3638366365336537306638323733363933316161326365630a643135346262343562346631633066
      31653164626435336263396565656461633263383865613137376637316638356665366133613538
      6130663236663136350a333264316464613038613666383432343230353664343637623263643934
      61336431313038303530356639373161663035666163373966316138336339633032
    scopes:
      - https://www.googleapis.com/auth/userinfo.profile
      - https://www.googleapis.com/auth/userinfo.email
    auth_url: https://accounts.google.com/o/oauth2/auth
    token_url: https://accounts.google.com/o/oauth2/token
    allowed_domains:
      - quorum.us
      - better-monitoring.quorum.us
    allow_sign_up: true
#  disable_login_form: false
#  oauth_auto_login: false
#  disable_signout_menu: false
#  signout_redirect_url: ""
#  anonymous:
#    org_name: "Main Organization"
#    org_role: Viewer
#  ldap:
#    config_file: "/etc/grafana/ldap.toml"
#    allow_sign_up: false
#  basic:
#    enabled: true

grafana_ldap: {}
#  verbose_logging: false
#  servers:
#    host: 127.0.0.1
#    port: 389 # 636 for SSL
#    use_ssl: false
#    start_tls: false
#    ssl_skip_verify: false
#    root_ca_cert: /path/to/certificate.crt
#    bind_dn: "cn=admin,dc=grafana,dc=org"
#    bind_password: grafana
#    search_filter: "(cn=%s)" # "(sAMAccountName=%s)" on AD
#    search_base_dns:
#      - "dc=grafana,dc=org"
#    group_search_filter: "(&(objectClass=posixGroup)(memberUid=%s))"
#    group_search_base_dns:
#      - "ou=groups,dc=grafana,dc=org"
#    attributes:
#      name: givenName
#      surname: sn
#      username: sAMAccountName
#      member_of: memberOf
#      email: mail
#  group_mappings:
#    - name: Main Org.
#      id: 1
#      groups:
#        - group_dn: "cn=admins,ou=groups,dc=grafana,dc=org"
#          org_role: Admin
#        - group_dn: "cn=editors,ou=groups,dc=grafana,dc=org"
#          org_role: Editor
#        - group_dn: "*"
#          org_role: Viewer
#    - name: Alternative Org
#      id: 2
#      groups:
#        - group_dn: "cn=alternative_admins,ou=groups,dc=grafana,dc=org"
#          org_role: Admin

grafana_session: {}
#  provider: file
#  provider_config: "sessions"

grafana_analytics: {}
#  reporting_enabled: true
#  google_analytics_ua_id: ""

# Set this for mail notifications
grafana_smtp:
  host: "localhost:25"
  from_address: admin@grafana.quorum.us
  from_name: Quorum Grafana Admin
  # user:
  # password:

# Enable grafana alerting mechanism
grafana_alerting:
  execute_alerts: true
#  error_or_timeout: 'alerting'
#  nodata_or_nullvalues: 'no_data'
#  concurrent_render_limit: 5

# Grafana logging configuration
grafana_log:
# mode: 'console file'
# level: info

# Internal grafana metrics system
grafana_metrics: {}
#  interval_seconds: 10
#  graphite:
#    address: "localhost:2003"
#    prefix: "prod.grafana.%(instance_name)s"

# Distributed tracing options
grafana_tracing: {}
#  address: "localhost:6831"
#  always_included_tag: "tag1:value1,tag2:value2"
#  sampler_type: const
#  sampler_param: 1

grafana_snapshots: {}
#  external_enabled: true
#  external_snapshot_url: "https://snapshots-origin.raintank.io"
#  external_snapshot_name: "Publish to snapshot.raintank.io"
#  snapshot_remove_expired: true
#  snapshot_TTL_days: 90

# External image store
grafana_image_storage: {}
#  provider: gcs
#  key_file:
#  bucket:
#  path:


#######
# Plugins from https://grafana.com/plugins
grafana_plugins:
  - raintank-worldping-app
  - grafana-piechart-panel
  - grafana-clock-panel
  - mtanda-google-calendar-datasource

# Dashboards from https://grafana.com/dashboards
grafana_dashboards: []
#  - dashboard_id: '4271'
#    revision_id: '3'
#    datasource: 'Prometheus'
#  - dashboard_id: '1860'
#    revision_id: '4'
#    datasource: 'Prometheus'
#  - dashboard_id: '358'
#    revision_id: '1'
#    datasource: 'Prometheus'

grafana_dashboards_dir: "dashboards"

# Alert notification channels to configure
grafana_alert_notifications: []

# Datasources to configure
grafana_datasources: []
#  - name: "Prometheus"
#    type: "prometheus"
#    access: "proxy"
#    url: "http://prometheus.mydomain"
#    basicAuth: true
#    basicAuthUser: "admin"
#    basicAuthPassword: "password"
#    isDefault: true
#    jsonData:
#      tlsAuth: false
#      tlsAuthWithCACert: false
#      tlsSkipVerify: true

# API keys to configure
grafana_api_keys: []
#  - name: "admin"
#    role: "Admin"
#  - name: "viewer"
#    role: "Viewer"
#  - name: "editor"
#    role: "Editor"

# The location where the keys should be stored.
grafana_api_keys_dir: "{{ lookup('env', 'HOME') }}/grafana/keys"

grafana_environment: {}
